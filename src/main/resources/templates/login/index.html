<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plantee - Tu Comunidad Bot√°nica</title>
    <!-- Enlace a Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Enlace a la hoja de estilos principal usando Thymeleaf -->
    <link rel="stylesheet" th:href="@{/login/css/index.css}">
    <!-- Enlace a Google Fonts para Poppins y Lora -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Lora:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
<!-- Encabezado global de la aplicaci√≥n -->
<header class="app-header">
    <div class="header-brand">
        <strong class="brand-name">Plantee</strong>
        <a th:href="@{/web/plantas/dashboard2}" class="btn btn-secondary header-btn" 
           style="margin-left: 10px; padding: 5px 10px;">
            <i class="fas fa-tachometer-alt"></i> Dashboard
        </a>
        </div>
    </div>
    <div class="header-actions">
        <i class="fas fa-search header-icon" id="search-icon" aria-label="Abrir barra de b√∫squeda"></i>

        <!-- Mostrar diferentes opciones seg√∫n si el usuario est√° logueado -->
        <div th:if="${usuarioNombre == null}">
            <!-- Usuario no logueado -->
            <a th:href="@{/web/login}" class="btn btn-primary" id="register-btn">Registrarse</a>
            <a th:href="@{/web/login}" class="btn btn-secondary" id="login-btn">Iniciar Sesi√≥n</a>
        </div>

        <div th:if="${usuarioNombre != null}">
            <!-- Usuario logueado -->
            <span class="user-welcome">Hola, <span th:text="${usuarioNombre}">Usuario</span></span>
            <a th:href="@{/web/login}" class="btn btn-secondary">Cerrar Sesi√≥n</a>
        </div>
    </div>
</header>

<!-- Barra de b√∫squeda desplegable -->
<div id="search-bar" class="search-bar hidden">
    <input type="text" placeholder="Buscar..." id="search-input" class="search-input" aria-label="Campo de b√∫squeda">
    <div id="search-suggestions" class="search-suggestions"></div>
</div>

<!-- Bot√≥n de alternar men√∫ lateral -->
<button id="menu-toggle" class="menu-toggle" aria-label="Abrir men√∫ de navegaci√≥n">‚ò∞</button>

<!-- Men√∫ de navegaci√≥n lateral (Sidebar) -->
<nav id="sidebar" class="sidebar">
    <a class="nav-link" href="#inicio"><i class="fas fa-home nav-icon"></i><span class="nav-text">Inicio</span></a>
    <a class="nav-link" href="#servicios"><i class="fas fa-tools nav-icon"></i><span class="nav-text">Servicios</span></a>
    <a class="nav-link" href="#catalogo"><i class="fas fa-images nav-icon"></i><span class="nav-text">Cat√°logo</span></a>
    <a class="nav-link" href="#contactanos"><i class="fas fa-envelope nav-icon"></i><span class="nav-text">Cont√°ctanos</span></a>

    <!-- Enlace al Dashboard solo si el usuario est√° logueado -->
    <a th:if="${usuarioNombre != null}"
       class="nav-link"
       th:href="@{/web/plantas/dashboard}"
       style="margin-top: auto; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 20px;">
        <i class="fas fa-user-circle nav-icon"></i>
        <span class="nav-text">Mi Cuenta</span>
    </a>

    <!-- Si no est√° logueado, mostrar enlace para login -->
    <a th:if="${usuarioNombre == null}"
       class="nav-link"
       th:href="@{/web/login}"
       style="margin-top: auto; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 20px;">
        <i class="fas fa-sign-in-alt nav-icon"></i>
        <span class="nav-text">Iniciar Sesi√≥n</span>
    </a>
</nav>

<!-- Contenido principal de la p√°gina -->
<main class="main-content">
    <!-- Secci√≥n de Inicio -->
    <section id="inicio" class="content-section hero-section">
        <h1 class="section-title">
            <span th:if="${usuarioNombre != null}">
                ¬°Hola <span th:text="${usuarioNombre}">Usuario</span>! Bienvenido a Plantee
            </span>
            <span th:if="${usuarioNombre == null}">
                Bienvenido a Plantee
            </span>
        </h1>
        <p class="section-description">Tu comunidad ideal para aprender y compartir sobre el fascinante mundo de las plantas. Explora nuestros eventos, participa en el foro, descubre nuestros servicios y sum√©rgete en nuestro cat√°logo bot√°nico. ¬°Con√©ctate con otros amantes de la naturaleza y haz que tu pasi√≥n florezca!</p>
        <div class="hero-actions">
            <!-- Enlaces que cambian seg√∫n el estado de autenticaci√≥n -->
            <div th:if="${usuarioNombre != null}">
                <a th:href="@{/web/plantas/dashboard#eventos}" class="btn btn-primary">Ver Eventos</a>
                <a th:href="@{/web/plantas/dashboard#foro}" class="btn btn-secondary">Unirse al Foro</a>
            </div>
            <div th:if="${usuarioNombre == null}">
                <a th:href="@{/web/login}" class="btn btn-primary">Iniciar Sesi√≥n para Ver Eventos</a>
                <a th:href="@{/web/login}" class="btn btn-secondary">Registrarse</a>
            </div>
        </div>
    </section>

    <!-- Secci√≥n de Servicios -->
    <section id="servicios" class="content-section service-section">
        <h2 class="section-title">Nuestros Servicios</h2>
        <p class="section-description">Ofrecemos una variedad de servicios para ayudarte a cuidar tus plantas y expandir tus conocimientos.</p>
        <div class="service-grid">
            <div class="service-card">
                <i class="fas fa-leaf service-icon"></i>
                <h3 class="service-card-title">Consultor√≠a de Jardiner√≠a</h3>
                <p class="service-card-description">Asesoramiento personalizado para el cuidado de tus plantas y soluci√≥n de problemas.</p>
            </div>
            <div class="service-card">
                <i class="fas fa-palette service-icon"></i>
                <h3 class="service-card-title">Dise√±o de Paisajes</h3>
                <p class="service-card-description">Creaci√≥n de espacios verdes est√©ticos y funcionales.</p>
            </div>
            <div class="service-card">
                <i class="fas fa-hand-holding-heart service-icon"></i>
                <h3 class="service-card-title">Mantenimiento de Jardines</h3>
                <p class="service-card-description">Servicio completo de poda, riego, abonado y limpieza.</p>
            </div>
            <div class="service-card">
                <i class="fas fa-bug service-icon"></i>
                <h3 class="service-card-title">Control de Plagas Org√°nico</h3>
                <p class="service-card-description">Soluciones ecol√≥gicas y seguras para combatir plagas.</p>
            </div>
            <div class="service-card">
                <i class="fas fa-store service-icon"></i>
                <h3 class="service-card-title">Venta de Semillas y Plantas</h3>
                <p class="service-card-description">Amplia variedad de semillas de calidad y plantas saludables.</p>
            </div>
            <div class="service-card">
                <i class="fas fa-chalkboard-teacher service-icon"></i>
                <h3 class="service-card-title">Talleres y Cursos</h3>
                <p class="service-card-description">Programas educativos sobre horticultura y t√©cnicas de jardiner√≠a.</p>
            </div>
        </div>
        <div class="text-center mt-8">
            <a th:href="@{/web/plantas/dashboard#servicios}"
               th:if="${usuarioNombre != null}"
               class="btn btn-primary">Ver Detalles de Servicios</a>
            <a th:href="@{/web/login}"
               th:if="${usuarioNombre == null}"
               class="btn btn-primary">Iniciar Sesi√≥n para Ver Servicios</a>
        </div>
    </section>

    <!-- Secci√≥n de Cat√°logo Bot√°nico -->
    <section id="catalogo" class="content-section">
        <h2 class="section-title">Cat√°logo Bot√°nico</h2>
        <p class="section-description">Descubre algunas de las hermosas plantas de nuestro cat√°logo.</p>
        <div class="carousel-wrapper">
            <button class="carousel-nav-btn left" id="carousel-prev-btn"><i class="fas fa-chevron-left"></i></button>
            <div class="carousel-track" id="carousel-track">
                <!-- Las im√°genes del carrusel se cargar√°n con JavaScript -->
            </div>
            <button class="carousel-nav-btn right" id="carousel-next-btn"><i class="fas fa-chevron-right"></i></button>
        </div>
        <div class="text-center mt-8">
            <a th:href="@{/web/plantas/catalogo}" class="btn btn-primary">Explorar Cat√°logo Completo</a>
        </div>
    </section>

    <!-- Secci√≥n de Contacto -->
    <section id="contactanos" class="content-section">
        <h2 class="section-title">Cont√°ctanos</h2>
        <p class="contact-info"><strong>Correo:</strong> contacto@plantee.com</p>
        <p class="contact-info"><strong>Tel√©fono:</strong> +51 987 654 321</p>
        <div th:if="${usuarioCorreo != null}" class="contact-info">
            <strong>Tu correo registrado:</strong> <span th:text="${usuarioCorreo}">correo@ejemplo.com</span>
        </div>
        <p class="contact-info social-links">
            <strong>S√≠guenos en redes:</strong>
            <a href="#" aria-label="Facebook de Plantee"><i class="fab fa-facebook-square social-icon facebook-color"></i></a>
            <a href="#" aria-label="Instagram de Plantee"><i class="fab fa-instagram-square social-icon instagram-color"></i></a>
        </p>
    </section>
</main>

<!-- Modal de informaci√≥n de fotos -->
<div class="photo-modal-overlay" id="photo-modal-overlay">
    <div class="photo-modal-content" id="photo-modal-content">
        <img src="" alt="Planta en detalle" class="modal-image">
        <h3 class="modal-title"><span class="sr-only">T√≠tulo de la foto</span></h3>
        <p class="modal-description"></p>
        <button class="photo-modal-close" aria-label="Cerrar modal de foto">&times;</button>
    </div>
</div>

<!-- Enlace al archivo JavaScript usando Thymeleaf -->
<script th:src="@{/login/js/auth.js}"></script>
<script th:src="@{/login/js/home.js}"></script>
<!-- Script para inicializar usuario en localStorage -->
<script>
    /*
(async function inicializarUsuario() {
    console.log('üîç Verificando usuario en localStorage...');
    
    const usuarioGuardado = localStorage.getItem('usuarioActual');
    if (usuarioGuardado) {
        console.log('‚úÖ Usuario ya existe en localStorage:', JSON.parse(usuarioGuardado));
        return;
    }
    
    console.log('‚ö†Ô∏è No hay usuario en localStorage, obteniendo desde servidor...');
    
    try {
        const response = await fetch('/web/usuario-actual', {
            method: 'GET',
            headers: { 'Accept': 'application/json' },
            credentials: 'include'
        });
        
        if (response.ok) {
            const usuarioData = await response.json();
            localStorage.setItem('usuarioActual', JSON.stringify(usuarioData));
            console.log('‚úÖ Usuario guardado en localStorage:', usuarioData);
        } else if (response.status === 401) {
            console.warn('‚ö†Ô∏è No hay sesi√≥n activa');
        }
    } catch (error) {
        console.error('‚ùå Error al obtener usuario:', error);
    }
})();*/
</script>
</body>
</html>